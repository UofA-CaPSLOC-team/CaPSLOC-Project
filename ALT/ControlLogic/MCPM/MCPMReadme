Handle the hard calculations and junk.
